<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Extract Comment from Quote Tweet | Slack Overflow tips &amp; tricks</title>
<meta name="keywords" content="twitter, retweets, data cleaning">
<meta name="description" content="Topic originally suggested by Jack Penzer, Data Scientist The Problem üö®Note this is only relevant to data that has not come from Sprinklr. Quoted retweets are classified as mentions in Sprinklr and only simple retweets are considered retweetsüö®
When creating bigram networks and performing topic modelling on Twitter data it can often be difficult to deal with retweets (RTs).
If we leave all RTs in the data set, the bigram networks will comprise only the most retweeted RTs, as will most of the topics inferred through topic modelling.">
<meta name="author" content="Jamie Hudson, Data Scientist">
<link rel="canonical" href="https://slack-overflow-help.netlify.app/post/2022-06-29-retweets/retweets/">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-233404530-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-233404530-1');
</script>
<link crossorigin="anonymous" href="/assets/css/stylesheet.f5cd59ea56957c99ecadcf027c42b755eddc79842563adbc375b7fcbc8a04dd8.css" integrity="sha256-9c1Z6laVfJnsrc8CfEK3Ve3ceYQlY628N1t/y8igTdg=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://slack-overflow-help.netlify.app/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://slack-overflow-help.netlify.app/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://slack-overflow-help.netlify.app/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://slack-overflow-help.netlify.app/apple-touch-icon.png">
<link rel="mask-icon" href="https://slack-overflow-help.netlify.app/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-233404530-1', 'auto');
	
	ga('send', 'pageview');
}
</script><meta property="og:title" content="Extract Comment from Quote Tweet" />
<meta property="og:description" content="Topic originally suggested by Jack Penzer, Data Scientist The Problem üö®Note this is only relevant to data that has not come from Sprinklr. Quoted retweets are classified as mentions in Sprinklr and only simple retweets are considered retweetsüö®
When creating bigram networks and performing topic modelling on Twitter data it can often be difficult to deal with retweets (RTs).
If we leave all RTs in the data set, the bigram networks will comprise only the most retweeted RTs, as will most of the topics inferred through topic modelling." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://slack-overflow-help.netlify.app/post/2022-06-29-retweets/retweets/" /><meta property="og:image" content="https://slack-overflow-help.netlify.app/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"/><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-06-29T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2022-06-29T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://slack-overflow-help.netlify.app/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"/>

<meta name="twitter:title" content="Extract Comment from Quote Tweet"/>
<meta name="twitter:description" content="Topic originally suggested by Jack Penzer, Data Scientist The Problem üö®Note this is only relevant to data that has not come from Sprinklr. Quoted retweets are classified as mentions in Sprinklr and only simple retweets are considered retweetsüö®
When creating bigram networks and performing topic modelling on Twitter data it can often be difficult to deal with retweets (RTs).
If we leave all RTs in the data set, the bigram networks will comprise only the most retweeted RTs, as will most of the topics inferred through topic modelling."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://slack-overflow-help.netlify.app/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Extract Comment from Quote Tweet",
      "item": "https://slack-overflow-help.netlify.app/post/2022-06-29-retweets/retweets/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Extract Comment from Quote Tweet",
  "name": "Extract Comment from Quote Tweet",
  "description": "Topic originally suggested by Jack Penzer, Data Scientist The Problem üö®Note this is only relevant to data that has not come from Sprinklr. Quoted retweets are classified as mentions in Sprinklr and only simple retweets are considered retweetsüö®\nWhen creating bigram networks and performing topic modelling on Twitter data it can often be difficult to deal with retweets (RTs).\nIf we leave all RTs in the data set, the bigram networks will comprise only the most retweeted RTs, as will most of the topics inferred through topic modelling.",
  "keywords": [
    "twitter", "retweets", "data cleaning"
  ],
  "articleBody": " Topic originally suggested by Jack Penzer, Data Scientist The Problem üö®Note this is only relevant to data that has not come from Sprinklr. Quoted retweets are classified as mentions in Sprinklr and only simple retweets are considered retweetsüö®\nWhen creating bigram networks and performing topic modelling on Twitter data it can often be difficult to deal with retweets (RTs).\nIf we leave all RTs in the data set, the bigram networks will comprise only the most retweeted RTs, as will most of the topics inferred through topic modelling.\nHowever, if we blanket remove all RTs, we will also lose the quote RTs, which contain text separate from the RT.\nThe Solution A happy medium is to remove the retweeted part of each quote RT, leaving the novel text to be analysed separately (which will not disrupt our bigram networks and topic modelling processes).\nWarning: check the specific output of RTs first as in the third code block.\nFirst things first, let‚Äôs load the libraries we will be using:\nlibrary(tidyverse) library(janitor) And then load in some sample data, which we will call demo. You will see I also select only a few columns, this is for clarity in visualising the data frame in this tutorial and we do not recommend selecting such few columns for a real-life situation.\ndemo \u003c- read_csv(\"data/demo.csv\") %\u003e% janitor::clean_names() %\u003e% dplyr::select(date, media_type, publisher_username, mention_content) utils::head(20) ## [1] 20 head(demo) ## # A tibble: 6 √ó 4 ## date media_type publisher_username mention_content ## ## 1 2022-06-02 Twitter PradoEirin La ilustraci√≥n de hoy en @_Boreal_ p‚Ä¶ ## 2 2022-06-02 Twitter AugustoMetztli La mayonesa, el pan bimbo‚Ä¶ y Get¬†Bac‚Ä¶ ## 3 2022-06-02 Twitter _Boreal_ La mayonesa, el pan bimbo‚Ä¶ y Get¬†Bac‚Ä¶ ## 4 2022-06-02 Twitter ANYWAYSNOW no hay absolutamente nada para desay‚Ä¶ ## 5 2022-06-02 Twitter monnuwrai despu√©s del caldito me com√≠ un pedaz‚Ä¶ ## 6 2022-06-02 Twitter nathmarz A punto de morir por comer unas puta‚Ä¶ In this example, we can see that our text variable is stored in a column called mention_content. For illustrative purposes, let‚Äôs rename this to text and then find us some RTs:\ndemo_RTs \u003c- demo %\u003e% dplyr::rename(text = mention_content) %\u003e% dplyr::select(text) %\u003e% dplyr::filter(str_detect(text, \"\\\\bRT\\\\b\")) We use the function str_detect() to search for strings within the text column that match the regex pattern \"\\\\bRT\\\\b. This pattern tells R to find the term ‚ÄúRT‚Äù before and after word boundaries (the transition between word and non-word characters), meaning we will not find words such as ‚ÄúFURTHER‚Äù, as the ‚ÄúRT‚Äù is not next to a word boundary.\nBy viewing demo_RTs, we can see we have two posts that match the filtering criteria:\ndemo_RTs ## # A tibble: 2 √ó 1 ## text ## ## 1 Se mamaron con los precios yo con un kilo de arroz y una bolsa pan de bimbo e‚Ä¶ ## 2 ¬°Uy, qu√© miedo! ¬øD√≥nde ha estado desde diciembre de 2018? Yo me acuerdo que u‚Ä¶ The eagle-eyed amongst us will notice both of these posts have the quoted text before a ‚Äù RT @‚Äù pattern- so they come with a RT tag followed by the username of the person they‚Äôre retweeting followed by the original tweet.\nNow let‚Äôs mutate a new column and name it rt_info. This will check if the post is a RT, and if it is, take the RT tag and the proceeding text and add it to a new column.\nThen in the next mutate we‚Äôll edit our text column, checking if each post is a RT, and if it is we‚Äôll extract all the text up to the RT tag and forget about the rest - which is stored in rt_info:\ndemo_RTs \u003c- demo_RTs %\u003e% mutate(rt_info = ifelse(str_detect(text, \"\\\\bRT\\\\b\"), str_match(text, \"\\\\bRT\\\\b @.*\"), \"emptystring\")) %\u003e% mutate(text = ifelse(str_detect(text, \"\\\\bRT\\\\b\"), str_match(text, \".* \\\\bRT\\\\b\"), text)) demo_RTs ## # A tibble: 2 √ó 2 ## text rt_info ## ## 1 Se mamaron con los precios yo con un kilo de arroz y una bolsa pan de‚Ä¶ RT @jo‚Ä¶ ## 2 ¬°Uy, qu√© miedo! ¬øD√≥nde ha estado desde diciembre de 2018? Yo me acuer‚Ä¶ RT @re‚Ä¶ Now we can see that our text column has two posts, each of them quoted RTs, and our rt_info column includes all information relating to the RT itself. Now we can analyse the quoted RTs, and the original tweets‚Äô information if need be.\nüö®Note leaving the ‚ÄúRT‚Äù at the end of the quoted RTs is intentional, so that posts can still be tracked easily as quote RTs, and in the topic modelling process we‚Äôll still see that the topic comprises a number of quote RTs, but can be removed with mutate (text = str_remove_all(text, \"\\\\bRT\\\\b\"))üö®\n",
  "wordCount" : "777",
  "inLanguage": "en",
  "datePublished": "2022-06-29T00:00:00Z",
  "dateModified": "2022-06-29T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Jamie Hudson, Data Scientist"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://slack-overflow-help.netlify.app/post/2022-06-29-retweets/retweets/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Slack Overflow tips \u0026 tricks",
    "logo": {
      "@type": "ImageObject",
      "url": "https://slack-overflow-help.netlify.app/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://slack-overflow-help.netlify.app/" accesskey="h" title="Slack Overflow (Alt + H)">
                <img src="https://slack-overflow-help.netlify.app/logo.png" alt="logo" aria-label="logo"
                    height="50">Slack Overflow</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://slack-overflow-help.netlify.app/share_packages/" title="SHARE package docs">
                    <span>SHARE package docs</span>
                </a>
            </li>
            <li>
                <a href="https://slack-overflow-help.netlify.app/categories/" title="R packages">
                    <span>R packages</span>
                </a>
            </li>
            <li>
                <a href="https://slack-overflow-help.netlify.app/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://slack-overflow-help.netlify.app/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://sharecreative.slack.com/archives/C03FEC4C33N" title="slack_overflow">
                    <span>slack_overflow</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://slack-overflow-help.netlify.app/">Home</a>&nbsp;¬ª&nbsp;<a href="https://slack-overflow-help.netlify.app/post/">Posts</a></div>
    <h1 class="post-title">
      Extract Comment from Quote Tweet
    </h1>
    <div class="post-meta"><span title='2022-06-29 00:00:00 +0000 UTC'>June 29, 2022</span>&nbsp;¬∑&nbsp;4 min&nbsp;¬∑&nbsp;777 words&nbsp;¬∑&nbsp;Jamie Hudson, Data Scientist

</div>
  </header> 
  <div class="post-content">


<div id="topic-originally-suggested-by-jack-penzer-data-scientist" class="section level4">
<h4><em>Topic originally suggested by Jack Penzer, Data Scientist</em></h4>
</div>
<div id="the-problem" class="section level2">
<h2>The Problem</h2>
<p>üö®<strong>Note this is only relevant to data that has not come from Sprinklr. Quoted retweets are classified as mentions in Sprinklr and only simple retweets are considered retweets</strong>üö®</p>
<p>When creating bigram networks and performing topic modelling on Twitter data it can often be difficult to deal with retweets (RTs).</p>
<p>If we leave all RTs in the data set, the bigram networks will comprise only the most retweeted RTs, as will most of the topics inferred through topic modelling.</p>
<p>However, if we blanket remove all RTs, we will also lose the quote RTs, which contain text separate from the RT.</p>
</div>
<div id="the-solution" class="section level2">
<h2>The Solution</h2>
<p>A happy medium is to remove the retweeted part of each quote RT, leaving the novel text to be analysed separately (which will not disrupt our bigram networks and topic modelling processes).</p>
<p>Warning: check the specific output of RTs first as in the third code block.</p>
<p>First things first, let‚Äôs load the libraries we will be using:</p>
<pre class="r"><code>library(tidyverse)
library(janitor)</code></pre>
<p>And then load in some sample data, which we will call <code>demo</code>. You will see I also select only a few columns, this is for clarity in visualising the data frame in this tutorial and we do not recommend selecting such few columns for a real-life situation.</p>
<pre class="r"><code>demo &lt;- read_csv(&quot;data/demo.csv&quot;) %&gt;%
  janitor::clean_names() %&gt;%
  dplyr::select(date, media_type, publisher_username, mention_content)
  utils::head(20)</code></pre>
<pre><code>## [1] 20</code></pre>
<pre class="r"><code>head(demo)</code></pre>
<pre><code>## # A tibble: 6 √ó 4
##   date       media_type publisher_username mention_content                      
##   &lt;date&gt;     &lt;chr&gt;      &lt;chr&gt;              &lt;chr&gt;                                
## 1 2022-06-02 Twitter    PradoEirin         La ilustraci√≥n de hoy en @_Boreal_ p‚Ä¶
## 2 2022-06-02 Twitter    AugustoMetztli     La mayonesa, el pan bimbo‚Ä¶ y Get¬†Bac‚Ä¶
## 3 2022-06-02 Twitter    _Boreal_           La mayonesa, el pan bimbo‚Ä¶ y Get¬†Bac‚Ä¶
## 4 2022-06-02 Twitter    ANYWAYSNOW         no hay absolutamente nada para desay‚Ä¶
## 5 2022-06-02 Twitter    monnuwrai          despu√©s del caldito me com√≠ un pedaz‚Ä¶
## 6 2022-06-02 Twitter    nathmarz           A punto de morir por comer unas puta‚Ä¶</code></pre>
<p>In this example, we can see that our text variable is stored in a column called <code>mention_content</code>. For illustrative purposes, let‚Äôs rename this to <code>text</code> and then find us some RTs:</p>
<pre class="r"><code>demo_RTs &lt;- demo %&gt;%
  dplyr::rename(text = mention_content) %&gt;%
  dplyr::select(text) %&gt;%
  dplyr::filter(str_detect(text, &quot;\\bRT\\b&quot;))</code></pre>
<p>We use the function <code>str_detect()</code> to search for strings within the <code>text</code> column that match the regex pattern <code>"\\bRT\\b</code>. This pattern tells R to find the term ‚ÄúRT‚Äù before and after word boundaries (the transition between word and non-word characters), meaning we will not find words such as ‚ÄúFURTHER‚Äù, as the ‚ÄúRT‚Äù is not next to a word boundary.</p>
<p>By viewing <code>demo_RTs</code>, we can see we have two posts that match the filtering criteria:</p>
<pre class="r"><code>demo_RTs</code></pre>
<pre><code>## # A tibble: 2 √ó 1
##   text                                                                          
##   &lt;chr&gt;                                                                         
## 1 Se mamaron con los precios yo con un kilo de arroz y una bolsa pan de bimbo e‚Ä¶
## 2 ¬°Uy, qu√© miedo! ¬øD√≥nde ha estado desde diciembre de 2018? Yo me acuerdo que u‚Ä¶</code></pre>
<p>The eagle-eyed amongst us will notice both of these posts have the quoted text before a ‚Äù RT @‚Äù pattern- so they come with a RT tag followed by the username of the person they‚Äôre retweeting followed by the original tweet.</p>
<p>Now let‚Äôs mutate a new column and name it <code>rt_info</code>. This will check if the post is a RT, and if it is, take the RT tag and the proceeding text and add it to a new column.</p>
<p>Then in the next mutate we‚Äôll edit our <code>text</code> column, checking if each post is a RT, and if it is we‚Äôll extract all the text up to the RT tag and forget about the rest - which is stored in rt_info:</p>
<pre class="r"><code>demo_RTs &lt;- demo_RTs  %&gt;%
  mutate(rt_info = ifelse(str_detect(text, &quot;\\bRT\\b&quot;), str_match(text, &quot;\\bRT\\b @.*&quot;), &quot;emptystring&quot;)) %&gt;%
  mutate(text = ifelse(str_detect(text, &quot;\\bRT\\b&quot;), str_match(text, &quot;.* \\bRT\\b&quot;), text))

demo_RTs</code></pre>
<pre><code>## # A tibble: 2 √ó 2
##   text                                                                   rt_info
##   &lt;chr&gt;                                                                  &lt;chr&gt;  
## 1 Se mamaron con los precios yo con un kilo de arroz y una bolsa pan de‚Ä¶ RT @jo‚Ä¶
## 2 ¬°Uy, qu√© miedo! ¬øD√≥nde ha estado desde diciembre de 2018? Yo me acuer‚Ä¶ RT @re‚Ä¶</code></pre>
<p>Now we can see that our <code>text</code> column has two posts, each of them quoted RTs, and our <code>rt_info</code> column includes all information relating to the RT itself. Now we can analyse the quoted RTs, and the original tweets‚Äô information if need be.</p>
<p>üö®<strong>Note leaving the ‚ÄúRT‚Äù at the end of the quoted RTs is intentional, so that posts can still be tracked easily as quote RTs, and in the topic modelling process we‚Äôll still see that the topic comprises a number of quote RTs, but can be removed with mutate <code>(text = str_remove_all(text, "\\bRT\\b"))</code></strong>üö®</p>
</div>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://slack-overflow-help.netlify.app/tags/twitter/">twitter</a></li>
      <li><a href="https://slack-overflow-help.netlify.app/tags/retweets/">retweets</a></li>
      <li><a href="https://slack-overflow-help.netlify.app/tags/data-cleaning/">data cleaning</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://slack-overflow-help.netlify.app/">Slack Overflow tips &amp; tricks</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a><p style="text-align:center"><span style="color:#7f8c8d"><em><span style="font-size:10px">&quot;Dont hate dplyr; hate the game&quot;</span></em></span></p>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
